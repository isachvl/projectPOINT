![[Pasted image 20251121124418.png]]
**У нас есть условно облако точек **
**Сначала мы применяем Input T-Net выравние по позе то есть без разнице в каком положение стоит обхект **
	Shared MLP(1024) раздуваем до 1024
	Max Pooling	 Находим максимум у каждой точки
	FC слои 	который сжимает матрицу  Max Pooling до 3на3 и перемножаем каждую точку на эту матрицу для выравниевание 
-**Раздуваем до 64 признаков **
-**Потом еще раздуваем До 1024 признаков **
-**Делаем Max Pooling **
-**И создаем FC слой для выравние признаков  **64×64 матрица****
-**Применяем его для всех точек получим Nx64**
-**Снова применяем Shared MLP(1024)**
-**Потом Классифицируем и сегментируем **
-**Классификация **
	делаем maxpolling 
	F_global (1024D) - FC - 512D - ReLU(удаление минусов) - FC - 256D - ReLU - FC - k
	и делаем софт макс для того что бы в проценты перевести все вероятности 
	
-**Сегментация**
	локальные признаки + с глобальными 1024+64 =1088
		и Shared MLP сдуваем до m классов 
 веса для FC находится в процессе обучения 
![[Pasted image 20251121125946.png]]
-**Sampling & Grouping**
    - Выбираем ключевые точки (например, с помощью FPS – farthest point sampling).
    - Для каждой ключевой точки формируем **локальную группу соседних точек** (radius-based или kNN).
    - **Цель:** посмотреть на маленький участок облака, а не на весь объект сразу.
-**Shared MLP на каждой группе**
    - Каждую точку внутри группы раздуваем до признаков (64D, 128D и т.д.)
    - Веса Shared MLP одинаковые для всех точек → порядок точек в группе не важен.
-**Local Max Pooling**
    - Для каждой группы берём **поэлементный максимум по точкам в группе** → получаем **один локальный вектор признаков для группы**.
    - Этот вектор описывает **локальную структуру участка облака**.
-**Иерархия / повторение**
    - Выбираем **новые ключевые точки** среди уже агрегированных локальных признаков.
    - Формируем **новые группы** (объединяя соседние локальные векторы).
    - Опять Shared MLP + Local Max Pooling → более крупные локальные признаки.
    - Так можно строить несколько уровней (мелкие → средние → крупные масштабы).
-**Глобальный Max Pooling**
    - После нескольких уровней локальной агрегации берём максимум по всем локальным признакам → **глобальный вектор**.
    - Используем для классификации всего объекта.